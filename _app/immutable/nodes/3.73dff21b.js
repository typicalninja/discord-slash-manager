import{L as Fe,s as je,f as y,l as q,a as D,g as b,h as R,m as j,d as E,c as V,r as Q,j as m,M as H,N as Be,i as X,u,O as ke,E as J,n as re,v as Pe,F as Le,w as ye,e as Ie,P as Ue}from"../chunks/scheduler.d1e8f134.js";import{S as xe,i as ze}from"../chunks/index.70f1320d.js";import"../chunks/paths.5c22c135.js";import{p as He}from"../chunks/stores.f237babf.js";import{f as Je}from"../chunks/api.a7c8d8cc.js";import{t as W}from"../chunks/constants.85e98373.js";import{b as $e}from"../chunks/localStore.3b7c62f8.js";import{w as se,d as de}from"../chunks/index.6b3c40ea.js";import{t as Xe}from"../chunks/Toaster.svelte_svelte_type_style_lang.7ad7c14e.js";var Ne=Object.prototype.hasOwnProperty;function be(e,n){var i,t;if(e===n)return!0;if(e&&n&&(i=e.constructor)===n.constructor){if(i===Date)return e.getTime()===n.getTime();if(i===RegExp)return e.toString()===n.toString();if(i===Array){if((t=e.length)===n.length)for(;t--&&be(e[t],n[t]););return t===-1}if(!i||typeof e=="object"){t=0;for(i in e)if(Ne.call(e,i)&&++t&&!Ne.call(n,i)||!(i in n)||!be(e[i],n[i]))return!1;return Object.keys(n).length===t}}return e!==e&&n!==n}function Ge(e){return new Promise(n=>{e.subscribe(n)()})}function Ke(e,n,i){e.update(t=>(qe(t,n,i),t))}function Qe(e){return JSON.parse(JSON.stringify(e))}function Ee(e){return e==null}function Me(e){return Ee(e)||Object.keys(e).length<=0}function Re(e){let n=[];for(const[,i]of Object.entries(e)){const t=typeof i=="object"?Re(i):[i];n=[...n,...t]}return n}function ve(e,n,i={}){for(const t in n)switch(!0){case(n[t].type==="object"&&!Me(n[t].fields)):{i[t]=ve(e[t],n[t].fields,{...i[t]});break}case n[t].type==="array":{const s=e&&e[t]?e[t]:[];i[t]=s.map(a=>{const c=ve(a,n[t].innerType.fields,{...i[t]});return Object.keys(c).length>0?c:""});break}default:i[t]=""}return i}const We=be;function Ce(e,n){if(Array.isArray(e))return e.map(t=>Ce(t,n));const i={};for(const t in e)i[t]=typeof e[t]=="object"&&!Ee(e[t])?Ce(e[t],n):n;return i}function qe(e,n,i){if(new Object(e)!==e)return e;Array.isArray(n)||(n=n.toString().match(/[^.[\]]+/g)||[]);const t=n.slice(0,-1).reduce((s,a,c)=>new Object(s[a])===s[a]?s[a]:s[a]=Math.trunc(Math.abs(n[c+1]))===+n[c+1]?[]:{},e);return t[n[n.length-1]]=i,e}const C={assignDeep:Ce,cloneDeep:Qe,deepEqual:We,getErrorsFromSchema:ve,getValues:Re,isEmpty:Me,isNullish:Ee,set:qe,subscribeOnce:Ge,update:Ke},we="",Ye=!0;function Ze(e){return e.getAttribute&&e.getAttribute("type")==="checkbox"}function et(e){return e.getAttribute&&e.getAttribute("type")==="file"}function tt(e){return et(e)?e.files:Ze(e)?e.checked:e.value}const nt=e=>{let n=e.initialValues||{};const i=e.validationSchema,t=e.validate,s=e.onSubmit,a={values:()=>C.cloneDeep(n),errors:()=>i?C.getErrorsFromSchema(n,i.fields):C.assignDeep(n,we),touched:()=>C.assignDeep(n,!Ye)},c=se(a.values()),f=se(a.errors()),N=se(a.touched()),d=se(!1),r=se(!1),v=de(f,l=>C.getValues(l).every(h=>h===we)),B=de(c,l=>{const o=C.assignDeep(l,!1);for(let h in l)o[h]=!C.deepEqual(l[h],n[h]);return o}),T=de(B,l=>C.getValues(l).includes(!0));function Y(l){return C.subscribeOnce(c).then(o=>$(l,o[l]))}function $(l,o){return O(l,!0),i?(r.set(!0),i.validateAt(l,Fe(c)).then(()=>C.update(f,l,"")).catch(h=>C.update(f,l,h.message)).finally(()=>{r.set(!1)})):t?(r.set(!0),Promise.resolve().then(()=>t({[l]:o})).then(h=>C.update(f,l,C.isNullish(h)?"":h[l])).finally(()=>{r.set(!1)})):Promise.resolve()}function S(l,o){return Z(l,o),$(l,o)}function G(l){const o=l.target,h=o.name||o.id,k=tt(o);return S(h,k)}function p(l){return l&&l.preventDefault&&l.preventDefault(),d.set(!0),C.subscribeOnce(c).then(o=>typeof t=="function"?(r.set(!0),Promise.resolve().then(()=>t(o)).then(h=>{if(C.isNullish(h)||C.getValues(h).length===0)return U(o);f.set(h),d.set(!1)}).finally(()=>r.set(!1))):i?(r.set(!0),i.validate(o,{abortEarly:!1}).then(()=>U(o)).catch(h=>{if(h&&h.inner){const k=a.errors();h.inner.map(K=>C.set(k,K.path,K.message)),f.set(k)}d.set(!1)}).finally(()=>r.set(!1))):U(o))}function A(){c.set(a.values()),f.set(a.errors()),N.set(a.touched())}function U(l){return Promise.resolve().then(()=>f.set(a.errors())).then(()=>s(l,c,f)).finally(()=>d.set(!1))}function Z(l,o){C.update(c,l,o)}function O(l,o){C.update(N,l,o)}function F(l){n=l,A()}return{form:c,errors:f,touched:N,modified:B,isValid:v,isSubmitting:d,isValidating:r,isModified:T,handleChange:G,handleSubmit:p,handleReset:A,updateField:Z,updateValidateField:S,updateTouched:O,validateField:Y,updateInitialValues:F,state:de([c,f,N,B,v,r,d,T],([l,o,h,k,K,te,L,x])=>({form:l,errors:o,touched:h,modified:k,isValid:K,isSubmitting:L,isValidating:te,isModified:x}))}};function Te(e){let n,i=e[2].name+"",t;return{c(){n=y("span"),t=q(i),this.h()},l(s){n=b(s,"SPAN",{class:!0});var a=R(n);t=j(a,i),a.forEach(E),this.h()},h(){m(n,"class","text-red-300 text-xs")},m(s,a){X(s,n,a),u(n,t)},p(s,a){a&4&&i!==(i=s[2].name+"")&&re(t,i)},d(s){s&&E(n)}}}function De(e){let n,i="Slash command Description",t,s,a,c,f,N,d=e[2].description&&Ve(e);return{c(){n=y("label"),n.textContent=i,t=D(),s=y("textarea"),a=D(),d&&d.c(),c=Ie(),this.h()},l(r){n=b(r,"LABEL",{for:!0,"data-svelte-h":!0}),Q(n)!=="svelte-10pjmlq"&&(n.textContent=i),t=V(r),s=b(r,"TEXTAREA",{name:!0,id:!0,placeholder:!0,class:!0}),R(s).forEach(E),a=V(r),d&&d.l(r),c=Ie(),this.h()},h(){m(n,"for","description"),m(s,"name","description"),m(s,"id","description"),m(s,"placeholder","Command description"),m(s,"class","bg-primary-500 rounded-md p-2 focus:ring-0 focus:ring-offset-0 focus:outline-none")},m(r,v){X(r,n,v),X(r,t,v),X(r,s,v),H(s,e[1].description),X(r,a,v),d&&d.m(r,v),X(r,c,v),f||(N=[J(s,"keyup",e[5]),J(s,"input",e[12])],f=!0)},p(r,v){v&2&&H(s,r[1].description),r[2].description?d?d.p(r,v):(d=Ve(r),d.c(),d.m(c.parentNode,c)):d&&(d.d(1),d=null)},d(r){r&&(E(n),E(t),E(s),E(a),E(c)),d&&d.d(r),f=!1,Le(N)}}}function Ve(e){let n,i=e[2].description+"",t;return{c(){n=y("span"),t=q(i),this.h()},l(s){n=b(s,"SPAN",{class:!0});var a=R(n);t=j(a,i),a.forEach(E),this.h()},h(){m(n,"class","text-red-300 text-xs")},m(s,a){X(s,n,a),u(n,t)},p(s,a){a&4&&i!==(i=s[2].description+"")&&re(t,i)},d(s){s&&E(n)}}}function it(e){let n,i,t,s,a,c=W(e[1].type)+"",f,N,d=e[0]==="global"?"global":`guild (${e[0]})`,r,v,B,T,Y="Command Name",$,S,G,p,A,U="Interaction type",Z,O,F,l="Chat input (Slash command)",o,h="User",k,K="Message",te,L,x,Se="Allow in Dm",fe,M,pe,ne,me,ae,z,he,ie=W(e[1].type)+"",le,_e,ge,Ae,P=e[2].name&&Te(e),I=e[1].type===1&&De(e);return{c(){n=y("div"),i=y("form"),t=y("div"),s=y("h1"),a=q("Add new "),f=q(c),N=q(" Interaction to "),r=q(d),v=q(" scope"),B=D(),T=y("label"),T.textContent=Y,$=D(),S=y("input"),G=D(),P&&P.c(),p=D(),A=y("label"),A.textContent=U,Z=D(),O=y("select"),F=y("option"),F.textContent=l,o=y("option"),o.textContent=h,k=y("option"),k.textContent=K,te=D(),L=y("label"),x=y("span"),x.textContent=Se,fe=D(),M=y("input"),pe=D(),ne=y("div"),me=D(),I&&I.c(),ae=D(),z=y("button"),he=q("Create "),le=q(ie),_e=q(" interaction"),this.h()},l(_){n=b(_,"DIV",{class:!0});var w=R(n);i=b(w,"FORM",{});var Oe=R(i);t=b(Oe,"DIV",{class:!0});var g=R(t);s=b(g,"H1",{class:!0});var ee=R(s);a=j(ee,"Add new "),f=j(ee,c),N=j(ee," Interaction to "),r=j(ee,d),v=j(ee," scope"),ee.forEach(E),B=V(g),T=b(g,"LABEL",{for:!0,"data-svelte-h":!0}),Q(T)!=="svelte-10dwz9d"&&(T.textContent=Y),$=V(g),S=b(g,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0,class:!0}),G=V(g),P&&P.l(g),p=V(g),A=b(g,"LABEL",{for:!0,"data-svelte-h":!0}),Q(A)!=="svelte-vif08u"&&(A.textContent=U),Z=V(g),O=b(g,"SELECT",{id:!0,name:!0,class:!0});var oe=R(O);F=b(oe,"OPTION",{"data-svelte-h":!0}),Q(F)!=="svelte-128lzjc"&&(F.textContent=l),o=b(oe,"OPTION",{"data-svelte-h":!0}),Q(o)!=="svelte-175cd0n"&&(o.textContent=h),k=b(oe,"OPTION",{"data-svelte-h":!0}),Q(k)!=="svelte-5g3ziw"&&(k.textContent=K),oe.forEach(E),te=V(g),L=b(g,"LABEL",{for:!0,class:!0});var ue=R(L);x=b(ue,"SPAN",{class:!0,"data-svelte-h":!0}),Q(x)!=="svelte-up74y2"&&(x.textContent=Se),fe=V(ue),M=b(ue,"INPUT",{name:!0,id:!0,class:!0,type:!0}),ue.forEach(E),pe=V(g),ne=b(g,"DIV",{class:!0}),R(ne).forEach(E),me=V(g),I&&I.l(g),ae=V(g),z=b(g,"BUTTON",{type:!0,class:!0});var ce=R(z);he=j(ce,"Create "),le=j(ce,ie),_e=j(ce," interaction"),ce.forEach(E),g.forEach(E),Oe.forEach(E),w.forEach(E),this.h()},h(){m(s,"class","text-xl font-bold"),m(T,"for","name"),m(S,"type","text"),m(S,"name","name"),m(S,"id","name"),m(S,"placeholder","Command name"),m(S,"class","bg-primary-500 rounded-md p-2 focus:ring-0 focus:ring-offset-0 focus:outline-none"),m(A,"for","type"),F.__value=1,H(F,F.__value),o.__value=2,H(o,o.__value),k.__value=3,H(k,k.__value),m(O,"id","type"),m(O,"name","type"),m(O,"class","bg-primary-500 rounded-md p-2 focus:ring-0 focus:ring-offset-0 focus:outline-none"),e[1].type===void 0&&Be(()=>e[10].call(O)),m(x,"class","mr-2"),m(M,"name","dm_permission"),m(M,"id","dm_permission"),m(M,"class","h-5 w-5 bg-primary-500 rounded focus:ring-0 focus:ring-offset-0 focus:outline-none"),m(M,"type","checkbox"),m(L,"for","dm_permission"),m(L,"class","inline-flex items-center"),m(ne,"class","w-full h-1 bg-primary-800 rounded-lg"),m(z,"type","submit"),m(z,"class","bg-blurple-600 hover:bg-blurple-700 p-2 rounded-lg"),m(t,"class","bg-primary-700 p-2 flex flex-col gap-3 rounded-lg"),m(n,"class","m-2")},m(_,w){X(_,n,w),u(n,i),u(i,t),u(t,s),u(s,a),u(s,f),u(s,N),u(s,r),u(s,v),u(t,B),u(t,T),u(t,$),u(t,S),H(S,e[1].name),u(t,G),P&&P.m(t,null),u(t,p),u(t,A),u(t,Z),u(t,O),u(O,F),u(O,o),u(O,k),ke(O,e[1].type,!0),u(t,te),u(t,L),u(L,x),u(L,fe),u(L,M),H(M,e[1].dm_permission),u(t,pe),u(t,ne),u(t,me),I&&I.m(t,null),u(t,ae),u(t,z),u(z,he),u(z,le),u(z,_e),ge||(Ae=[J(S,"keyup",e[5]),J(S,"input",e[9]),J(O,"keyup",e[5]),J(O,"change",e[10]),J(M,"keyup",e[5]),J(M,"change",e[11]),J(i,"submit",e[6])],ge=!0)},p(_,[w]){w&2&&c!==(c=W(_[1].type)+"")&&re(f,c),w&1&&d!==(d=_[0]==="global"?"global":`guild (${_[0]})`)&&re(r,d),w&2&&S.value!==_[1].name&&H(S,_[1].name),_[2].name?P?P.p(_,w):(P=Te(_),P.c(),P.m(t,p)):P&&(P.d(1),P=null),w&2&&ke(O,_[1].type),w&2&&H(M,_[1].dm_permission),_[1].type===1?I?I.p(_,w):(I=De(_),I.c(),I.m(t,ae)):I&&(I.d(1),I=null),w&2&&ie!==(ie=W(_[1].type)+"")&&re(le,ie)},i:Pe,o:Pe,d(_){_&&E(n),P&&P.d(),I&&I.d(),ge=!1,Le(Ae)}}}function st(e,n,i){let t,s,a,c,f,N;ye(e,He,p=>i(8,c=p));const d=Fe($e),{form:r,errors:v,handleChange:B,handleSubmit:T}=nt({initialValues:{type:1,name:"",description:"",dm_permission:!0},validate:p=>{var U;let A={};return console.log(p),p.name===""?A.name=`${W(p.type||1)} interaction must have a name`:((U=p==null?void 0:p.name)==null?void 0:U.length)<3&&(A.name="Interaction name length must be greater than 3"),p.description===""&&p.type==1&&(A.description="Description is required for chat input interactions"),A},onSubmit:p=>{const A={type:p.type,name:p.name};p.type===1&&(A.description=p.description),Xe.promise(Je(a,{method:"POST",data:A}),{loading:`Adding ${W(p.type)} ${p.name}`,success:`Added ${W(p.type)} ${p.name}, you can continue adding commands`,error:`Error occurred while adding "${p.name}"`})}});ye(e,r,p=>i(1,f=p)),ye(e,v,p=>i(2,N=p));function Y(){f.name=this.value,r.set(f)}function $(){f.type=Ue(this),r.set(f)}function S(){f.dm_permission=this.value,r.set(f)}function G(){f.description=this.value,r.set(f)}return e.$$.update=()=>{e.$$.dirty&256&&i(7,t=c.url.searchParams),e.$$.dirty&128&&i(0,s=t.get("guildId")||"global"),e.$$.dirty&1&&(a=s!=="global"?`applications/${d.id}/guilds/${s}/commands`:`applications/${d.id}/commands`)},[s,f,N,r,v,B,T,t,c,Y,$,S,G]}class mt extends xe{constructor(n){super(),ze(this,n,st,it,je,{})}}export{mt as component};
