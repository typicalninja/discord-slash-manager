import{s as J,f as h,a as w,l as K,g as m,h as B,r as E,c as C,m as X,d as M,j as s,i as Y,u as r,L as q,E as F,v as G,F as Z,Q as $,o as ee}from"../chunks/scheduler.be789cb2.js";import{S as te,i as re}from"../chunks/index.63f467a8.js";import{a as A,b as ne}from"../chunks/localStore.c58327a0.js";import{g as Q}from"../chunks/navigation.1fac6f6a.js";import{f as oe,g as se}from"../chunks/api.e1335fde.js";import{d as ae}from"../chunks/constants.16a8be40.js";import{b as W}from"../chunks/paths.2cfd9c56.js";import{t as P}from"../chunks/Toaster.svelte_svelte_type_style_lang.7ad7c14e.js";async function le(){const t=await oe("oauth2/@me"),{application:a}=t.data;return(a==null?void 0:a.bot)??{}}function ie(t){let a,e,c,I="Login",p,l,v="Enter your client id and client secret",T,y,x="NOT your client token",k,i,_=`Data is not sent to any 3rd party servers,
            everything you do is only recorded to the <span class="font-bold">localStorage</span> and can be deleted if you need to.`,L,b,S='Get your application credentials from here <a href="https://discord.com/developers/applications" class="text-blurple-200 hover:underline">discord.com/developers/applications</a>',D,d,N,u,U,g,j,O,H,z,R;return{c(){a=h("div"),e=h("div"),c=h("h1"),c.textContent=I,p=w(),l=h("p"),l.textContent=v,T=w(),y=h("p"),y.textContent=x,k=w(),i=h("p"),i.innerHTML=_,L=w(),b=h("p"),b.innerHTML=S,D=w(),d=h("input"),N=w(),u=h("input"),U=w(),g=h("button"),j=K("Login with token ðŸš€"),this.h()},l(n){a=m(n,"DIV",{class:!0});var f=B(a);e=m(f,"DIV",{class:!0});var o=B(e);c=m(o,"H1",{class:!0,"data-svelte-h":!0}),E(c)!=="svelte-1iq98bf"&&(c.textContent=I),p=C(o),l=m(o,"P",{class:!0,"data-svelte-h":!0}),E(l)!=="svelte-15jhly7"&&(l.textContent=v),T=C(o),y=m(o,"P",{class:!0,"data-svelte-h":!0}),E(y)!=="svelte-8qzf74"&&(y.textContent=x),k=C(o),i=m(o,"P",{class:!0,"data-svelte-h":!0}),E(i)!=="svelte-1erpz9n"&&(i.innerHTML=_),L=C(o),b=m(o,"P",{"data-svelte-h":!0}),E(b)!=="svelte-15pky1h"&&(b.innerHTML=S),D=C(o),d=m(o,"INPUT",{type:!0,id:!0,placeholder:!0,class:!0}),N=C(o),u=m(o,"INPUT",{type:!0,id:!0,placeholder:!0,class:!0}),U=C(o),g=m(o,"BUTTON",{class:!0});var V=B(g);j=X(V,"Login with token ðŸš€"),V.forEach(M),o.forEach(M),f.forEach(M),this.h()},h(){s(c,"class","font-bold font-mono text-3xl"),s(l,"class","text-lg"),s(y,"class","text-sm font-bold"),s(i,"class","text-sm font-medium text-primary-300"),s(d,"type","text"),s(d,"id","clientId"),d.readOnly=t[2],s(d,"placeholder","Client Id"),s(d,"class","bg-primary-500 rounded-md p-2 focus:ring-0 focus:ring-offset-0 focus:outline-none"),s(u,"type","password"),s(u,"id","clientSecret"),u.readOnly=t[2],s(u,"placeholder","Client Secret"),s(u,"class","bg-primary-500 rounded-md p-2 focus:ring-0 focus:ring-offset-0 focus:outline-none"),g.disabled=O=t[3]||t[2],s(g,"class",H=(t[2]||t[3]?"bg-primary-600 cursor-not-allowed":"bg-blurple-600 hover:bg-blurple-700")+" p-2 rounded-lg"),s(e,"class","bg-primary-800 shadow-lg shadow-primary-900 border border-primary-700 opacity-90 rounded-lg p-3 w-1/2 flex flex-col gap-2 mt-9"),s(a,"class","flex justify-center")},m(n,f){Y(n,a,f),r(a,e),r(e,c),r(e,p),r(e,l),r(e,T),r(e,y),r(e,k),r(e,i),r(e,L),r(e,b),r(e,D),r(e,d),q(d,t[0]),r(e,N),r(e,u),q(u,t[1]),r(e,U),r(e,g),r(g,j),z||(R=[F(d,"input",t[5]),F(u,"input",t[6]),F(g,"click",t[4])],z=!0)},p(n,[f]){f&4&&(d.readOnly=n[2]),f&1&&d.value!==n[0]&&q(d,n[0]),f&4&&(u.readOnly=n[2]),f&2&&u.value!==n[1]&&q(u,n[1]),f&12&&O!==(O=n[3]||n[2])&&(g.disabled=O),f&12&&H!==(H=(n[2]||n[3]?"bg-primary-600 cursor-not-allowed":"bg-blurple-600 hover:bg-blurple-700")+" p-2 rounded-lg")&&s(g,"class",H)},i:G,o:G,d(n){n&&M(a),z=!1,Z(R)}}}function de(t,a,e){let c,I=$(A),p=I.clientId,l=I.clientSecret,v=!1;async function T(){if(!c){e(2,v=!0),A.update(i=>({...i,clientId:p,clientSecret:l}));try{const i=await se(p,l);A.update(S=>({...S,accessToken:i}));const{username:_,discriminator:L,id:b}=await le();if(typeof _!="string"||typeof b!="string")throw new TypeError("API Returned non string values");return ne.set({username:_,discriminator:L,id:b}),e(2,v=!1),Q(`${W}/dashboard`)}catch(i){throw console.log("Error while verifying",i),A.update(_=>({..._,accessToken:""})),e(2,v=!1),P.error("Error occurred while logging in"),P.error(`${i}`),new Error("Failed to login")}}}async function y(){if(!ae.test(p))return P.error("Client ID is invalid");P.promise(T(),{loading:"Logging in...",success:"Logged in, redirecting...",error:"Could not log in, check your credentials"})}ee(()=>{I.accessToken!==""&&(P.success("Already logged in, redirecting"),Q(`${W}/dashboard`))});function x(){p=this.value,e(0,p)}function k(){l=this.value,e(1,l)}return t.$$.update=()=>{t.$$.dirty&3&&e(3,c=p===""||l==="")},[p,l,v,c,y,x,k]}class be extends te{constructor(a){super(),re(this,a,de,ie,J,{})}}export{be as component};
